/**
 * Yuki Chat Widget - Minified Version
 * Usage: <script src="https://yourdomain.com/widget/chat-widget.min.js" data-page-id="YOUR_FACEBOOK_PAGE_ID"></script>
 */
!(function () {
  "use strict";
  const e = {
    pageId: null,
    theme: {
      primaryColor: "#0084FF",
      textColor: "#1C1E21",
      backgroundColor: "#FFFFFF",
      borderRadius: "8px",
    },
    position: "bottom-right",
    messages: {
      welcome: "Hi! How can we help you?",
      clickToChat: "Click to start chatting",
      poweredBy: "Powered by Yuki Chat",
    },
  };
  let t = !1,
    n = null;
  function i() {
    if (t) return;
    const i = document.querySelector("script[data-page-id]");
    if (!i)
      return void console.error(
        "Yuki Chat Widget: data-page-id attribute is required"
      );
    e.pageId = i.getAttribute("data-page-id");
    const o = i.getAttribute("data-theme");
    if (o)
      try {
        Object.assign(e.theme, JSON.parse(o));
      } catch (e) {
        console.warn("Yuki Chat Widget: Invalid theme JSON");
      }
    const r = i.getAttribute("data-position");
    r && (e.position = r);
    const s = i.getAttribute("data-welcome-message");
    s && (e.messages.welcome = s),
      (function () {
        (n = document.createElement("div")),
          (n.id = "yuki-chat-widget"),
          (n.innerHTML = (function () {
            const t = e.position.includes("right")
              ? "right: 20px;"
              : "left: 20px;";
            return `\n      <div class="yuki-widget-container" style="${t}">\n        <div class="yuki-chat-button" id="yuki-chat-button">\n          <div class="yuki-chat-icon">\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M20 2H4C2.9 2 2 2.9 2 4V16C2 17.1 2.9 18 4 18H6L10 22L14 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM20 16H13.17L10 19.17L6.83 16H4V4H20V16Z" fill="white"/>\n              <path d="M7 9H17V11H7V9ZM7 12H15V14H7V12ZM7 6H17V8H7V6Z" fill="white"/>\n            </svg>\n          </div>\n          <div class="yuki-chat-pulse"></div>\n        </div>\n        <div class="yuki-chat-preview" id="yuki-chat-preview" style="display: none;">\n          <div class="yuki-preview-header">\n            <div class="yuki-preview-title">\n              <strong>Customer Support</strong>\n            </div>\n            <div class="yuki-preview-close" id="yuki-preview-close">Ã—</div>\n          </div>\n          <div class="yuki-preview-body">\n            <div class="yuki-preview-message">\n              <div class="yuki-message-bubble">\n                ${e.messages.welcome}\n              </div>\n            </div>\n            <div class="yuki-preview-actions">\n              <button class="yuki-messenger-btn" id="yuki-messenger-btn">\n                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">\n                  <path d="M12 2C6.48 2 2 6.48 2 12C2 14.4 2.85 16.6 4.25 18.35L2.05 22.95L6.65 20.75C8.4 22.15 10.6 23 13 23H12C17.52 23 22 18.52 22 13V12C22 6.48 17.52 2 12 2Z" fill="#0084FF"/>\n                </svg>\n                Continue on Messenger\n              </button>\n            </div>\n          </div>\n          <div class="yuki-preview-footer">\n            <small>${e.messages.poweredBy}</small>\n          </div>\n        </div>\n      </div>\n    `;
          })()),
          (function () {
            if (document.getElementById("yuki-widget-styles")) return;
            const t = document.createElement("style");
            (t.id = "yuki-widget-styles"),
              (t.textContent = `\n      .yuki-widget-container {\n        position: fixed;\n        bottom: 20px;\n        z-index: 10000;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;\n      }\n      .yuki-chat-button {\n        position: relative;\n        width: 60px;\n        height: 60px;\n        background: ${e.theme.primaryColor};\n        border-radius: 50%;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n        transition: all 0.3s ease;\n        margin-left: auto;\n      }\n      .yuki-chat-button:hover {\n        transform: scale(1.1);\n        box-shadow: 0 6px 25px rgba(0, 0, 0, 0.2);\n      }\n      .yuki-chat-icon svg {\n        transition: transform 0.3s ease;\n      }\n      .yuki-chat-button:hover .yuki-chat-icon svg {\n        transform: scale(1.1);\n      }\n      .yuki-chat-pulse {\n        position: absolute;\n        width: 60px;\n        height: 60px;\n        border-radius: 50%;\n        background: ${e.theme.primaryColor};\n        opacity: 0.7;\n        animation: yuki-pulse 2s infinite;\n      }\n      @keyframes yuki-pulse {\n        0% {\n          transform: scale(1);\n          opacity: 0.7;\n        }\n        70% {\n          transform: scale(1.4);\n          opacity: 0;\n        }\n        100% {\n          transform: scale(1.4);\n          opacity: 0;\n        }\n      }\n      .yuki-chat-preview {\n        position: absolute;\n        bottom: 80px;\n        right: 0;\n        width: 320px;\n        max-width: calc(100vw - 40px);\n        background: ${e.theme.backgroundColor};\n        border-radius: ${e.theme.borderRadius};\n        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);\n        overflow: hidden;\n        animation: yuki-slideUp 0.3s ease;\n      }\n      @keyframes yuki-slideUp {\n        from {\n          opacity: 0;\n          transform: translateY(20px);\n        }\n        to {\n          opacity: 1;\n          transform: translateY(0);\n        }\n      }\n      .yuki-preview-header {\n        background: ${e.theme.primaryColor};\n        color: white;\n        padding: 15px 20px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      .yuki-preview-title {\n        font-size: 16px;\n        font-weight: 600;\n      }\n      .yuki-preview-close {\n        cursor: pointer;\n        font-size: 20px;\n        line-height: 1;\n        opacity: 0.8;\n        transition: opacity 0.2s;\n      }\n      .yuki-preview-close:hover {\n        opacity: 1;\n      }\n      .yuki-preview-body {\n        padding: 20px;\n      }\n      .yuki-preview-message {\n        margin-bottom: 15px;\n      }\n      .yuki-message-bubble {\n        background: #F0F2F5;\n        padding: 12px 16px;\n        border-radius: 18px;\n        color: ${e.theme.textColor};\n        font-size: 14px;\n        line-height: 1.4;\n        max-width: 85%;\n      }\n      .yuki-messenger-btn {\n        width: 100%;\n        background: #0084FF;\n        color: white;\n        border: none;\n        padding: 12px 16px;\n        border-radius: 25px;\n        font-size: 14px;\n        font-weight: 600;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 8px;\n        transition: all 0.2s ease;\n      }\n      .yuki-messenger-btn:hover {\n        background: #0066CC;\n        transform: translateY(-1px);\n      }\n      .yuki-preview-footer {\n        padding: 10px 20px;\n        text-align: center;\n        background: #F8F9FA;\n        color: #65676B;\n        font-size: 11px;\n      }\n      @media (max-width: 480px) {\n        .yuki-widget-container {\n          right: 10px !important;\n          left: 10px !important;\n        }\n        .yuki-chat-preview {\n          width: 100%;\n          right: 0;\n          left: 0;\n        }\n      }\n      .yuki-widget-container[data-position="bottom-left"] .yuki-chat-preview {\n        right: auto;\n        left: 0;\n      }\n    `),
              document.head.appendChild(t);
          })(),
          document.body.appendChild(n);
      })(),
      (function () {
        const e = document.getElementById("yuki-chat-button"),
          t = document.getElementById("yuki-chat-preview"),
          i = document.getElementById("yuki-preview-close"),
          s = document.getElementById("yuki-messenger-btn");
        e.addEventListener("click", function (e) {
          e.preventDefault(),
            e.stopPropagation(),
            "none" === t.style.display ? o() : r();
        }),
          i.addEventListener("click", function (e) {
            e.preventDefault(), e.stopPropagation(), r();
          }),
          s.addEventListener("click", function (e) {
            e.preventDefault(), e.stopPropagation(), c();
          }),
          document.addEventListener("click", function (e) {
            n.contains(e.target) || r();
          }),
          document.addEventListener("keydown", function (e) {
            "Escape" === e.key && r();
          });
      })(),
      (t = !0),
      console.log("Yuki Chat Widget initialized");
  }
  function o() {
    (document.getElementById("yuki-chat-preview").style.display = "block"),
      s("widget_opened");
  }
  function r() {
    document.getElementById("yuki-chat-preview").style.display = "none";
  }
  function c() {
    if (!e.pageId)
      return void console.error(
        "Yuki Chat Widget: Facebook Page ID not configured"
      );
    s("messenger_opened");
    const t = `https://m.me/${e.pageId}`;
    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
      navigator.userAgent
    )
      ? (window.location.href = t)
      : window.open(
          t,
          "_blank",
          "width=400,height=600,scrollbars=yes,resizable=yes"
        ),
      r();
  }
  function s(e, t = {}) {
    console.log("Yuki Chat Widget Event:", e, t),
      "undefined" != typeof gtag &&
        gtag("event", e, { event_category: "yuki_chat_widget", ...t });
  }
  (window.YukiChatWidget = {
    show: o,
    hide: r,
    openMessenger: c,
    setConfig: function (t) {
      Object.assign(e, t);
    },
  }),
    "loading" === document.readyState
      ? document.addEventListener("DOMContentLoaded", i)
      : i();
})();
